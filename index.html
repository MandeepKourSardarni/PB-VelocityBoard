<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>PB VelocityBoard 4.0</title>

<!-- Chart.js (future expansion) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Confetti -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
/* --------------------------------------------------
   GLOBAL THEME
-------------------------------------------------- */
body {
    margin: 0;
    font-family: "Segoe UI", sans-serif;
    background: #021f4f;        /* Royal Blue */
    color: white;
    overflow-x: hidden;
}

/* Headings */
h2 {
    margin: 15px;
    color: #2ee7e7; /* Teal */
    font-size: 20px;
}

/* Buttons */
button {
    background: #2ee7e7;
    color: #00152f;
    padding: 10px 18px;
    border-radius: 8px;
    font-weight: bold;
    border: none;
    cursor: pointer;
}
button:hover {
    background: #57f1f1;
}

/* --------------------------------------------------
   ATHLETE SETUP SCREEN
-------------------------------------------------- */
#athleteSetup {
    text-align: center;
    padding: 40px 20px;
}

#athleteSetup input {
    width: 75%;
    padding: 12px;
    margin: 10px 0;
    border-radius: 8px;
    border: 1px solid #2ee7e7;
    background: #053067;
    color: white;
    font-size: 16px;
}

/* Hide main content until athlete is set */
#mainApp { display: none; }

/* --------------------------------------------------
   HEADER (NAME + AGE)
-------------------------------------------------- */
#headerBar {
    text-align: center;
    padding: 20px 10px;
    background: #032862;
    font-size: 18px;
    color: #2ee7e7;
    font-weight: bold;
    letter-spacing: 1px;
}

/* --------------------------------------------------
   PB TILES (OPTION 1 STYLE)
-------------------------------------------------- */
#pbTiles {
    margin: 10px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
}

.pbTile {
    background: #053067;
    padding: 12px;
    border-radius: 12px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
}

.pbTile .distance {
    font-size: 16px;
    color: #2ee7e7;
}

.pbTile .time {
    font-size: 26px;
    margin: 6px 0;
    font-weight: bold;
}

.pbTile .meta {
    font-size: 12px;
    opacity: 0.8;
}

/* --------------------------------------------------
   ADD ENTRY BUTTON
-------------------------------------------------- */
#addEntryBtn {
    width: calc(100% - 30px);
    margin: 20px 15px;
    padding: 14px;
    font-size: 16px;
    border-radius: 10px;
}

/* --------------------------------------------------
   ENTRY CARDS
-------------------------------------------------- */
.entryCard {
    background: #04204f;
    padding: 15px;
    margin: 12px;
    border-radius: 10px;
    border-left: 4px solid #2ee7e7;
}

/* --------------------------------------------------
   POP-UP MODAL
-------------------------------------------------- */
#entryModal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.65);
    justify-content: center;
    align-items: center;
}

#modalBox {
    background: #032862;
    padding: 20px;
    width: 92%;
    max-width: 520px;
    border-radius: 12px;
}

/* Two-column grid */
.modalGrid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 12px;
}

#modalBox input {
    width: 100%;
    padding: 10px;
    background: #053067;
    border: 1px solid #2ee7e7;
    border-radius: 6px;
    color: white;
}

.modalActions {
    text-align: right;
    margin-top: 18px;
}

</style>
</head>
<body>

<!-- --------------------------------------------------
     ATHLETE SETUP
-------------------------------------------------- -->
<div id="athleteSetup">
    <h2>Enter Athlete Details</h2>
    <input id="athName" placeholder="Athlete Name">
    <input id="athAge" type="number" placeholder="Age">
    <br><br>
    <button onclick="saveAthlete()">Save & Continue</button>
</div>

<!-- --------------------------------------------------
     MAIN APPLICATION
-------------------------------------------------- -->
<div id="mainApp">

    <!-- HEADER -->
    <div id="headerBar"></div>

    <!-- PB TILES -->
    <h2>Personal Bests</h2>
    <div id="pbTiles">
        <div class="pbTile" id="pb400"><div class="distance">400m</div><div class="time">--</div><div class="meta"></div></div>
        <div class="pbTile" id="pb500"><div class="distance">500m</div><div class="time">--</div><div class="meta"></div></div>
        <div class="pbTile" id="pb800"><div class="distance">800m</div><div class="time">--</div><div class="meta"></div></div>
        <div class="pbTile" id="pb1000"><div class="distance">1000m</div><div class="time">--</div><div class="meta"></div></div>
        <div class="pbTile" id="pb1200"><div class="distance">1200m</div><div class="time">--</div><div class="meta"></div></div>
        <div class="pbTile" id="pb1500"><div class="distance">1500m</div><div class="time">--</div><div class="meta"></div></div>
    </div>

    <!-- ADD ENTRY -->
    <button id="addEntryBtn" onclick="openEntryModal()">+ Add Entry</button>

    <!-- ENTRY LIST -->
    <div id="entryList"></div>

</div>

<!-- --------------------------------------------------
     ENTRY MODAL
-------------------------------------------------- -->
<div id="entryModal">
    <div id="modalBox">
        <h2>Add Race Entry</h2>

        <label>Location</label>
        <input id="entryLocation" />

        <label style="margin-top:10px;">Date</label>
        <input id="entryDate" type="date" />

        <div class="modalGrid">
            <div>
                <label>400m</label>
                <input id="t400">
            </div>
            <div>
                <label>500m</label>
                <input id="t500">
            </div>

            <div>
                <label>800m</label>
                <input id="t800">
            </div>
            <div>
                <label>1000m</label>
                <input id="t1000">
            </div>

            <div>
                <label>1200m</label>
                <input id="t1200">
            </div>
            <div>
                <label>1500m</label>
                <input id="t1500">
            </div>
        </div>

        <div class="modalActions">
            <button onclick="closeEntryModal()">Cancel</button>
            <button onclick="saveEntry()">Save</button>
        </div>

    </div>
</div>

<script>
/* =======================================================
   GLOBAL VARIABLES
======================================================= */
let entries = [];
const dists = [400,500,800,1000,1200,1500];

/* =======================================================
   ATHLETE SETUP
======================================================= */
function saveAthlete() {
    let name = athName.value.trim();
    let age = athAge.value.trim();

    if (!name || !age) {
        alert("Enter both name and age.");
        return;
    }

    localStorage.setItem("pbName", name);
    localStorage.setItem("pbAge", age);

    loadAthlete();
}

function loadAthlete() {
    let name = localStorage.getItem("pbName");
    let age = localStorage.getItem("pbAge");

    if (name) {
        athleteSetup.style.display = "none";
        mainApp.style.display = "block";
        headerBar.innerHTML = `${name} — Age ${age}`;
    }
}

loadAthlete();

/* =======================================================
   MODAL OPEN/CLOSE
======================================================= */
function openEntryModal() {
    entryModal.style.display = "flex";
}

function closeEntryModal() {
    entryModal.style.display = "none";
}

/* =======================================================
   SAVE ENTRY
======================================================= */
function saveEntry() {
    let loc = entryLocation.value.trim();
    let date = entryDate.value;
    if (!loc || !date) { alert("Location and date required."); return; }

    let entry = {
        location: loc,
        date: date,
        times: {}
    };

    dists.forEach(d => {
        let v = document.getElementById("t"+d).value.trim();
        entry.times[d] = v ? parseFloat(v) : null;
    });

    entries.push(entry);
    updatePBs();
    renderEntries();
    closeEntryModal();
}

/* =======================================================
   PB UPDATE
======================================================= */
function updatePBs() {
    dists.forEach(d => {
        let best = Infinity;
        let bestMeta = "";

        entries.forEach(e => {
            if (e.times[d] !== null && e.times[d] < best) {
                best = e.times[d];
                bestMeta = `${formatDate(e.date)} • ${e.location}`;
            }
        });

        let tile = document.getElementById("pb"+d);
        let timeBox = tile.querySelector(".time");
        let metaBox = tile.querySelector(".meta");

        if (best === Infinity) {
            timeBox.textContent = "--";
            metaBox.textContent = "";
        } else {
            timeBox.textContent = best + "s";
            metaBox.textContent = bestMeta;
        }
    });
}

/* =======================================================
   ENTRY LIST RENDER
======================================================= */
function renderEntries() {
    entryList.innerHTML = "";

    entries.forEach(e => {
        let div = document.createElement("div");
        div.className = "entryCard";

        let html = `<strong>${e.location}</strong><br>${formatDate(e.date)}<br><br>`;

        dists.forEach(d => {
            if (e.times[d] !== null) {
                html += `${d}m: ${e.times[d]}s<br>`;
            }
        });

        div.innerHTML = html;
        entryList.appendChild(div);
    });
}

/* =======================================================
   DATE FORMAT (Option A — “Feb 12, 2025”)
======================================================= */
function formatDate(val) {
    let d = new Date(val);
    return d.toLocaleDateString("en-US", { month:"short", day:"numeric", year:"numeric" });
}

</script>

</body>
</html>
